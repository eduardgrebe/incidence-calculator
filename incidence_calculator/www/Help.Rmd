## Analysis of survey data


Once a population level survey has been carried out, the fully specified data set will essentially consist of subject level records indicating demographic factors, cluster/stratum membership, and various clinical indicators such as final HIV status and recency status.

A cross sectional survey leads to a core dataset with typical (germaine to the present application) columns

* Subject ID (a meaningless serial number)
* Primary sampling unit (cluster ID)
* Weight (based on estimates of demographic/geographic structure)
* Stratum (an ID indicating strata such as age, rage, (rural/urban) settlement type,.. )
* Gender/Sex (no need to settle heated debates here - M/F will do)
* HIV status (0/1 for -/+ respectively)
* Recency Status (0/1 for Non-recent/Recent respectively)

This data will usually be processed by somewhat ad-hoc means, depending on what kind of sampling frame was employed, and what kinds of weights are available. The estimation can be somewhat generalized for certain standard sampling frame types, and there are standard R packages (like *survey*) which can do this. For the present application, the data should be reduced, by whatever means available to the user, to

*	an estimate of HIV prevalence
*	an estimate of the prevalence of ‘recent infection’ amongst those who are HIV positive.
*	A variance/covariance matrix for these two prevalence estimates

While the calculator has no particular requirements or expectations about how these estimates are to be obtained, they need to be provided in the specified format, either by hand into the interface (one survey per transaction of the calculator), or by uploading a file (which makes it possible to provide estimates from multiple surveys in one transaction of the calculator). This choice is made in the top horizontal box of the *Estimate Incidence* tab. Depending on the choice, the page adapts to handle the estimates accordingly. Either way, by using primarily the *inctools* function `incprops`, the calculator will report:

* the (user provided) HIV Prevalence (point estimate and standard error)
* an incidence point estimate and standard error
* the equivalent annualised risk of infection (which is usually numerically very similar)
* the correlation/covariance of HIV Prevalence and Incidence (including an approximate CI ?? REALLY ??)
* implied confidence intervals on MDRI and FRR derived from input parameters provided as PEs and RSEs)


### Entering Survey Results in the Form

Having chosen to enter survey estimates "via a form", there is a further choice, to be made in the *Data type* box, namely whether to supply *estimated prevalences* or *sample counts*.


#### Entering Raw Sample Counts

By *counts* we here mean providing, in the *Survey Data* box, raw survey counts of

* subjects tested for HIV
* positive results
* recency ascertainments (on a completely random subset of positives)
* 'recent' results

This option would hopefully provide merely a preliminary analysis.

In the preloaded example, the values are:
* 5000 subjects tested for HIV
* 1000 positive results (an unweighted HIV prevalence of 20%, estimated with a standard error of 0.56%)
* 900 recency ascertainments on a completely random 900 of the 1000 positives, leading to 45 'recent' (and hence 855 'non recent') results, for a prevalence of recent infection, amongst HIV positives, of 10%, with a relative standard error of 9%

It is worth changing the recency results into 1000 ascertainments (i.e. 100% coverage) and the number of 'recent' results to 50, and noting the slight improvement in precision this produces in the incidenc estimate


#### Entering Prevalences Estimated with Sampling Complexities Accounted

From the same underlying data set that generated the counts just used above, one should ideally take account of sampling complexities and directly obtain (for example by using the R package *survey*)
*	an estimate of HIV prevalence
*	an estimate of the prevalence of ‘recent infection’ amongst those who are HIV positive.
*	A variance/covariance matrix for these two prevalence estimates
which can be entered into the *Survey Data* box when choosing the *Data Type* as *estimated prevalences*

This is preloaded with:
*	an estimate of HIV prevalence
*	an estimate of the prevalence of ‘recent infection’ amongst those who are HIV positive.
*	A variance/covariance matrix for these two prevalence estimates


### Entering Survey Results Via a File

If one chooses to enter survey estimates "via a file", data from multiple surveys can be analysed in a single calculator transaction, by uploading a CSV file with exactly these columns:

* Year
* Prevalence_percent
* SE_Prevalence
* PropRecent_percent
* SE_PropRecent
* Corr_Prev_PropRecent
* MDRI_days
* SE_MDRI
* FRR_percent
* SE_FRR
* BigT

An example file can be [downloaded here](example_survey_input.csv), saved to the users storage, and then uploaded into the calculator.


### Providing Recency Test Properties

The Recency Test performance defining parameters are supplied in the fields of the ‘Recency Test’ box, which is found on both the form based and file based versions of the *Calculate Incidence* tab. These are preloaded to reflect a recency test with
* an MDRI of 200 days, estimated with a standard error of 10 days
* an FRR of 0.5%, estimated with a standard error of 0.1 percentage points
* a recency time cut off (T) of 730 (i.e 2 Years) - set on a slider

It is interesting to explore how rapidly precision deteriorates as one increases the FRR and/or it's uncertainty. Leaving survey data fixed, and at suitably small FRR, the point estimate and precision of incidence both scale roughly inversely with MDRI.
